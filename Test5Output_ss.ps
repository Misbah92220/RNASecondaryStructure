%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.3.1
%%CreationDate: Mon Dec  5 15:13:58 2016
%%Title: RNA Secondary Structure Plot
%%BoundingBox: 0 0 700 700
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

%Options: 
% to switch off outline pairs of sequence comment or
% delete the appropriate line near the end of the file

%%BeginProlog
/RNAplot 100 dict def
RNAplot begin
/fsize  14 def
/outlinecolor {0.2 setgray} bind def
/paircolor    {0.2 setgray} bind def
/seqcolor     {0   setgray} bind def
/cshow  { dup stringwidth pop -2 div fsize -3 div rmoveto show} bind def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/arccoords { % i j arccoords
  % puts optimal x1 y1 x2 y2 coordinates used in bezier curves from i to j
  % onto the stack
  dup 3 -1 roll dup 4 -1 roll lt dup dup 5 2 roll {exch} if
  dup 3 -1 roll dup 3 -1 roll exch sub 1 sub dup
  4 -2 roll 5 -1 roll {exch} if 4 2 roll
  sequence length dup 2 div exch 3 1 roll lt 
  {exch 5 -1 roll pop 4 -2 roll exch 4 2 roll}
  { 4 2 roll 5 -1 roll dup 6 1 roll {exch} if
    4 -2 roll exch pop dup 3 -1 roll dup 4 1 roll
    exch add 4 -1 roll dup 5 1 roll sub 1 sub
    5 -1 roll not {4 -2 roll exch 4 2 roll} if
  }ifelse
   % compute the scalingfactor and prepare (1-sf) and sf*r
  2 mul exch cpr 3 1 roll div dup
  3 -1 roll mul exch 1 exch sub exch
   % compute the coordinates
  3 -1 roll 1 sub coor exch get aload pop % get coord for i
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate y1
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate x1
  5 -1 roll 1 sub coor exch get aload pop % get coord for j
  % duplicate j coord
  dup 3 -1 roll dup 4 1 roll exch 8 2 roll
  6 -1 roll dup 7 1 roll mul 5 -1 roll dup 6 1 roll add exch % calculate y2
  6 -1 roll mul 5 -1 roll add exch % calculate x2
  6 -2 roll % reorder
} bind def
/drawoutline {
  gsave outlinecolor newpath
  coor 0 get aload pop 0.8 0 360 arc % draw 5' circle of 1st sequence
  currentdict /cutpoint known        % check if cutpoint is defined
  {coor 0 cutpoint getinterval
   {aload pop lineto} forall         % draw outline of 1st sequence
   coor cutpoint 1 add get aload pop
   2 copy moveto 0.8 0 360 arc       % draw 5' circle of 2nd sequence
   coor cutpoint 1 add coor length cutpoint 1 add sub getinterval
   {aload pop lineto} forall}        % draw outline of 2nd sequence
  {coor {aload pop lineto} forall}   % draw outline as a whole
  ifelse
  stroke grestore
} bind def
/drawpairs {
  paircolor
  0.7 setlinewidth
  [9 3.01] 9 setdash
  newpath
  pairs {aload pop
      currentdict (cpr) known
      { exch dup
        coor  exch 1 sub get aload pop moveto
        exch arccoords curveto
      }
      { coor exch 1 sub get aload pop moveto
        coor exch 1 sub get aload pop lineto
      }ifelse
  } forall
  stroke
} bind def
% draw bases
/drawbases {
  [] 0 setdash
  seqcolor
  0
  coor {
    aload pop moveto
    dup sequence exch 1 getinterval cshow
    1 add
  } forall
  pop
} bind def

/init {
  /Helvetica findfont fsize scalefont setfont
  1 setlinejoin
  1 setlinecap
  0.8 setlinewidth
  % find the coordinate range
  /xmax -1000 def /xmin 10000 def
  /ymax -1000 def /ymin 10000 def
  coor {
      aload pop
      dup ymin lt {dup /ymin exch def} if
      dup ymax gt {/ymax exch def} {pop} ifelse
      dup xmin lt {dup /xmin exch def} if
      dup xmax gt {/xmax exch def} {pop} ifelse
  } forall
  /size {xmax xmin sub ymax ymin sub max} bind def
  /width {xmax xmin sub} bind def
  /height {ymax ymin sub} bind def
  10 10 translate
  680 size 10 add div dup scale
  size width sub width xmin sub xmax sub add 2 div 5 add
  size height sub height ymin sub ymax sub add 2 div 5 add
  translate
} bind def
end
%%EndProlog
RNAplot begin
% data start here
/sequence (\
GAAUUGCGGGAAAGGGGUCAACAGCCGUUCAGUACCAAGUCUCAGGGGAAACUUUGAGAUGGCCUUGCAAAGGGUAUGGUAAUAAGCUGACGGACAUGGUCCUAACCACGCAGCCAAGUCCUAAGUCAACAGAUCUUCUGUUGAUAUGGAUGCAGUUC\
) def
/coor [
[100.00000000 100.00000000]
[115.00000000 100.00000000]
[107.14948273 87.21839905]
[107.45546722 72.22151947]
[115.82080078 59.77076721]
[129.58955383 53.81916809]
[144.39024353 56.25631332]
[155.52375793 66.30842590]
[159.45527649 80.78402710]
[173.45532227 75.39898682]
[186.39440918 82.98715210]
[188.52912903 97.83447266]
[178.25199890 108.76061249]
[181.70903015 123.35681152]
[196.36039734 120.14159393]
[211.26188660 121.85787201]
[224.79869080 128.31965637]
[235.50390625 138.82672119]
[238.98323059 124.23582458]
[251.02738953 115.29501343]
[237.92417908 107.99392700]
[229.28642273 95.73059845]
[226.82493591 80.93394470]
[231.02723694 66.53461456]
[241.06101990 55.38457870]
[254.93896484 49.69223785]
[269.91238403 50.58503342]
[283.01559448 57.88613129]
[291.65335083 70.14945984]
[294.11483765 84.94612122]
[289.91253662 99.34544373]
[279.87875366 110.49547577]
[266.00079346 116.18780518]
[276.89718628 126.49645996]
[278.61804199 141.39741516]
[288.87518311 130.45249939]
[300.83447266 121.39849091]
[314.15188599 114.49584961]
[328.44430542 109.94315338]
[343.30053711 107.87136841]
[358.29321289 108.34010315]
[372.99102783 111.33587646]
[386.97113037 116.77249908]
[380.32675171 103.32436371]
[382.00775146 88.41885376]
[391.48043823 76.78836060]
[405.73727417 72.12548065]
[420.25183105 75.91065216]
[430.41583252 86.94210052]
[433.00228882 101.71742249]
[427.19000244 115.54556274]
[414.82434082 124.03617859]
[399.83132935 124.49356079]
[411.20169067 134.27696228]
[420.75509644 145.84123230]
[428.21670532 158.85369873]
[433.37188721 172.94001770]
[436.07229614 187.69494629]
[436.24026489 202.69400024]
[433.87097168 217.50570679]
[429.03256226 231.70394897]
[421.86425781 244.88026428]
[412.57223511 256.65557861]
[401.42382812 266.69116211]
[388.73974609 274.69830322]
[374.88491821 280.44665527]
[360.25790405 283.77084351]
[345.27947998 284.57522583]
[330.38058472 282.83666992]
[315.98980713 278.60519409]
[302.52114868 272.00253296]
[310.68603516 284.58563232]
[311.87896729 269.63314819]
[317.23617554 255.62243652]
[326.32366943 243.68855286]
[338.40521240 234.79832458]
[352.50204468 229.67198181]
[367.47210693 228.72482300]
[382.10263062 232.03358459]
[395.20831299 239.33021545]
[405.72744751 250.02357483]
[412.80780029 263.24737549]
[415.87576294 277.93026733]
[414.68280029 292.88275146]
[409.32556152 306.89346313]
[400.23806763 318.82733154]
[388.15652466 327.71755981]
[374.05969238 332.84390259]
[359.08963013 333.79104614]
[344.45910645 330.48226929]
[331.35342407 323.18563843]
[320.83432007 312.49224854]
[313.75396729 299.26846313]
[311.31066895 314.06814575]
[303.68612671 326.98580933]
[291.91003418 336.27688599]
[277.57284546 340.68652344]
[262.61087036 339.61920166]
[249.04479980 333.21905518]
[238.70680237 322.35049438]
[232.99308777 308.48132324]
[232.67532349 293.48468018]
[237.79641724 279.38595581]
[247.66474915 268.08923340]
[260.94754028 261.12020874]
[275.85089111 259.42007446]
[290.36199951 263.21844482]
[279.86230469 252.50601196]
[275.54364014 266.87088013]
[261.62008667 272.45077515]
[248.57637024 265.04391479]
[246.23466492 250.22782898]
[256.35830688 239.15933228]
[271.32400513 240.17323303]
[264.99279785 226.57484436]
[261.05081177 212.10208130]
[259.61145020 197.17129517]
[260.71609497 182.21202087]
[264.33297729 167.65461731]
[270.35806274 153.91786194]
[255.98228455 158.20004272]
[242.21726990 152.23982239]
[244.21153259 167.10665894]
[241.27047729 181.81550598]
[233.71282959 194.77243042]
[222.35755920 204.57334900]
[208.43519592 210.15617371]
[221.44856262 217.61622620]
[228.36288452 230.92758179]
[226.98292542 245.86396790]
[217.74681091 257.68319702]
[222.69636536 271.84307861]
[208.53649902 276.79263306]
[203.58694458 262.63275146]
[188.99897766 259.14117432]
[178.61448669 248.31701660]
[175.73046875 233.59687805]
[181.26258850 219.65429688]
[193.45443726 210.91593933]
[179.03869629 206.77030945]
[166.75012207 198.16851807]
[157.92036438 186.04269409]
[153.50627136 171.70686340]
[153.98619080 156.71453857]
[159.30809021 142.69036865]
[168.89527893 131.15408325]
[157.51908875 121.37746429]
[163.30177307 107.53691864]
[154.93649292 95.08613586]
[143.40220642 104.67572021]
[128.51441956 106.50708008]
[137.86671448 118.23458862]
[141.20446777 132.85852051]
[137.86659241 147.48242188]
[128.51419067 159.20985413]
[114.99962616 165.71804810]
[99.99962616 165.71797180]
[86.48512268 159.20965576]
] def
/pairs [
[2 151]
[9 149]
[13 148]
[14 146]
[18 122]
[20 33]
[35 120]
[43 53]
[71 107]
[72 93]
[108 114]
[127 139]
[131 134]
] def

init

% switch off outline pairs or bases by removing these lines
drawoutline
drawpairs
drawbases
% show it
showpage
end
%%EOF
